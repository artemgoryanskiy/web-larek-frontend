# Веб-ларек - интернет-магазин цифровых товаров

## Оглавление
- [Описание проекта](#описание-проекта)
- [Технологический стек](#технологический-стек)
- [Функциональность](#функциональность)
- [Установка и запуск](#установка-и-запуск)
- [Структура проекта](#структура-проекта)
- [Архитектура](#архитектура)
    - [Паттерн MVP](#паттерн-mvp)
    - [Система событий](#система-событий)
    - [Жизненный цикл приложения](#жизненный-цикл-приложения)
- [Основные компоненты](#основные-компоненты)
- [API Интерфейс](#api-интерфейс)
- [Форматы данных](#форматы-данных)
- [Процесс покупки](#процесс-покупки)

## Описание проекта

"Веб-ларек" - это одностраничное веб-приложение (SPA) для продажи цифровых товаров, включающее в себя каталог товаров, корзину покупок и систему оформления заказов. Проект создан как демонстрация современных веб-технологий и архитектурных подходов.

Приложение позволяет пользователям:
- Просматривать каталог цифровых товаров в различных категориях
- Получать детальную информацию о каждом товаре
- Добавлять товары в корзину покупок и управлять её содержимым
- Оформлять заказы с выбором способа оплаты
- Указывать адрес доставки и контактную информацию
- Получать подтверждение успешного оформления заказа

Проект разработан с использованием архитектурного паттерна MVP (Model-View-Presenter), что обеспечивает чёткое разделение ответственностей, улучшает тестируемость кода и облегчает его дальнейшую поддержку и развитие.

## Технологический стек

### Frontend
- **HTML5** - семантическая разметка страницы для обеспечения доступности и SEO-оптимизации
- **SCSS** - препроцессор CSS для более удобной и модульной стилизации компонентов
- **TypeScript** (v5.0.4) - строго типизированный язык, надстройка над JavaScript, обеспечивающая раннее обнаружение ошибок и улучшенную интеграцию с IDE

### Инструменты сборки и разработки
- **Webpack** (v5.81.0) - сборщик модулей, оптимизирующий и объединяющий все ресурсы проекта
- **Babel** (v7.21.5) - транспилятор кода, обеспечивающий совместимость с различными браузерами
- **PostCSS** (v8.4.23) - инструмент для трансформации CSS с плагинами
    - **Autoprefixer** (v10.4.14) - автоматическое добавление вендорных префиксов
- **ESLint** (v8.39.0) - линтер для выявления проблем в JavaScript/TypeScript коде
    - **ESLint-config-prettier** (v8.8.0) - интеграция с Prettier
- **Prettier** (v2.8.8) - инструмент для форматирования кода
- **TypeScript ESLint** (v5.59.1/v5.59.2) - дополнительные правила для TypeScript

### Зависимости
- **Sass** (v1.62.1) - компилятор SCSS в CSS
- **Terser Webpack Plugin** (v5.3.10) - минификация JavaScript
- **HTML Webpack Plugin** (v5.5.1) - генерация HTML-файлов
- **Mini CSS Extract Plugin** (v2.7.5) - извлечение CSS в отдельные файлы

### Пакетный менеджер
- **Yarn** - быстрый и надёжный менеджер пакетов для Node.js

## Функциональность

### Просмотр каталога товаров
- Отображение списка всех доступных товаров
- Группировка товаров по категориям:
    - Софт-скиллы
    - Хард-скиллы
    - Кнопки
    - Дополнительные товары
    - Другое
- Адаптивная сетка для разных размеров экрана

### Детальное представление товара
- Просмотр расширенной информации в модальном окне:
    - Полное описание товара
    - Крупное изображение
    - Категория товара
    - Цена
- Кнопка добавления/удаления товара из корзины

### Корзина покупок
- Отображение всех выбранных товаров
- Возможность удаления отдельных позиций
- Автоматический подсчёт общей суммы
- Кнопка перехода к оформлению заказа
- Счётчик товаров в шапке сайта

### Оформление заказа
1. **Форма адреса и способа оплаты**:
    - Выбор способа оплаты (карта/наличные)
    - Поле для ввода адреса доставки
    - Валидация введённых данных

2. **Форма контактной информации**:
    - Ввод email с валидацией формата
    - Ввод телефона с валидацией формата
    - Проверка заполнения всех обязательных полей

### Подтверждение заказа
- Отображение уведомления об успешном оформлении заказа
- Информация об общей сумме списанных средств
- Кнопка закрытия для возврата в каталог
- Автоматическая очистка корзины после успешного оформления

## Установка и запуск

### Предварительные требования
- Node.js (рекомендуется v16.x или выше)
- Yarn (рекомендуется v1.22.x или выше)
- Git (для клонирования репозитория)

### Шаги по установке

1. **Клонирование репозитория**:
```shell script
git clone <url-репозитория>
cd web-larek
```


2. **Установка зависимостей**:
```shell script
yarn install
```


3. **Запуск в режиме разработки**:
```shell script
yarn start
```

Приложение будет доступно по адресу: http://localhost:8080
Режим разработки включает:
- Hot Module Replacement (HMR) для мгновенного обновления интерфейса при изменении кода
- Генерацию source maps для удобной отладки
- ESLint для проверки кода в реальном времени

### Дополнительные команды

#### Проверка кода
```shell script
yarn lint
```


#### Форматирование кода
```shell script
yarn format
```


#### Сборка для продакшена
```shell script
yarn build
```

Собранный проект будет находиться в директории `/dist` и оптимизирован для производительности:
- Минифицированный JavaScript и CSS
- Оптимизированные изображения
- Все статические ресурсы с хеш-суффиксами для эффективного кеширования

#### Публикация на GitHub Pages
```shell script
yarn deploy
```


## Структура проекта

```
web-larek/
├── src/                   # Исходные файлы
│   ├── components/        # Компоненты приложения
│   │   ├── base/          # Базовые компоненты и классы
│   │   │   ├── api.ts     # Базовый класс для работы с API
│   │   │   ├── Component.ts # Базовый класс для UI-компонентов
│   │   │   ├── events.ts  # Система событий (EventEmitter)
│   │   │   ├── Model.ts   # Базовый класс для моделей данных
│   │   ├── common/        # Общие компоненты
│   │   │   ├── Form.ts    # Базовый класс для форм
│   │   │   ├── Modal.ts   # Компонент модального окна
│   │   │   ├── Basket.ts  # Компонент корзины
│   │   ├── Card.ts        # Компоненты карточек товаров
│   │   ├── AppData.ts     # Модель данных приложения
│   │   ├── LarekAPI.ts    # API для взаимодействия с сервером
│   │   ├── OrderAddressForm.ts # Форма адреса доставки
│   │   ├── OrderContactForm.ts # Форма контактных данных
│   │   ├── OrderSuccess.ts # Компонент успешного заказа
│   │   ├── Page.ts        # Компонент главной страницы
│   ├── scss/              # Стили SCSS
│   │   ├── components/    # Стили компонентов
│   │   ├── mixins/        # SCSS-миксины
│   │   ├── variables.scss # Переменные SCSS
│   │   ├── styles.scss    # Основной файл стилей
│   ├── types/             # TypeScript типы и интерфейсы
│   │   ├── index.ts       # Основные типы данных
│   ├── utils/             # Утилиты и вспомогательные функции
│   │   ├── constants.ts   # Константы приложения
│   │   ├── utils.ts       # Вспомогательные функции
│   ├── index.ts           # Точка входа приложения
│   ├── index.html         # Основной HTML-файл
├── public/                # Статические файлы
│   ├── images/            # Изображения товаров
│   ├── favicon.ico        # Иконка сайта
├── webpack/               # Конфигурация Webpack по окружениям
│   ├── webpack.common.js  # Общая конфигурация
│   ├── webpack.dev.js     # Конфигурация для разработки
│   ├── webpack.prod.js    # Конфигурация для продакшена
├── webpack.config.js      # Основной файл конфигурации Webpack
├── tsconfig.json          # Конфигурация TypeScript
├── .eslintrc.js           # Конфигурация ESLint
├── .prettierrc            # Конфигурация Prettier
├── .gitignore             # Игнорируемые Git файлы
├── package.json           # Зависимости и скрипты
├── yarn.lock              # Фиксация версий пакетов
└── README.md              # Документация проекта
```


## Архитектура

### Паттерн MVP

Проект реализован с использованием архитектурного паттерна MVP (Model-View-Presenter):

- **Model (Модель)**:
    - Отвечает за хранение и управление данными
    - Представлена классами AppData.ts и LarekAPI.ts
    - Не зависит от представления и презентера
    - Взаимодействует с другими компонентами через систему событий

- **View (Представление)**:
    - Отвечает за отображение данных пользователю
    - Включает компоненты пользовательского интерфейса
    - Передает действия пользователя презентеру через события
    - Основные компоненты: Card.ts, Form.ts, Modal.ts, Page.ts

- **Presenter (Презентер)**:
    - Является связующим звеном между моделью и представлением
    - Реагирует на события от представления и модели
    - Реализован в основном файле приложения index.ts
    - Обрабатывает бизнес-логику и обновляет модель и представление

### Система событий

Компоненты взаимодействуют друг с другом через систему событий (EventEmitter), что обеспечивает:
- Слабую связанность компонентов (компоненты не зависят напрямую друг от друга)
- Гибкую архитектуру, легкую для модификации и расширения
- Возможность тестирования компонентов в изоляции
- Улучшенную поддержку кода

Ключевые события приложения:
- `items:changed` - обновление каталога товаров
- `card:select` - выбор карточки товара
- `basket:changed` - изменение состояния корзины
- `basket:open` - открытие корзины
- `order:open` - открытие формы заказа
- `orderAddress:submit` - отправка формы адреса
- `orderContact:submit` - отправка формы контактов
- `modal:open` - открытие модального окна
- `modal:close` - закрытие модального окна

### Жизненный цикл приложения

1. **Инициализация**:
    - Создание экземпляров EventEmitter, LarekAPI и AppState
    - Регистрация обработчиков событий
    - Получение шаблонов компонентов

2. **Загрузка данных**:
    - API-клиент запрашивает список товаров с сервера
    - Данные преобразуются в модели ProductItem
    - Модель AppState обновляется и генерирует событие обновления каталога

3. **Рендеринг интерфейса**:
    - Компонент Page отображает каталог товаров
    - Обработчики событий прикрепляются к элементам интерфейса

4. **Взаимодействие с пользователем**:
    - Пользователь взаимодействует с интерфейсом (клики, ввод данных)
    - События передаются через систему EventEmitter соответствующим обработчикам
    - Обработчики обновляют модель и/или представление

5. **Завершение работы**:
    - Очистка ресурсов при закрытии приложения
    - Сохранение необходимых данных (при необходимости)

## Основные компоненты

### 1. **`Component.ts`**
Базовый класс для всех UI-компонентов. Предоставляет общие методы для работы с DOM:
- **Методы**:
    - `toggleClass`: переключение CSS-классов элемента
    - `setText`: установка текстового содержимого
    - `setDisabled`: управление состоянием блокировки элемента
    - `setHidden`/`setVisible`: управление видимостью элемента
    - `setImage`: установка изображения с alt-текстом
    - `render`: обновление и отображение компонента

### 2. **`Model.ts`**
Базовый класс для моделей данных:
- **Свойства**:
    - `events`: экземпляр системы событий
- **Методы**:
    - `emitChanges`: отправка уведомления об изменении данных модели

### 3. **`EventEmitter.ts`**
Реализация брокера событий:
- **Методы**:
    - `on`: подписка на события
    - `off`: отписка от событий
    - `emit`: генерация события
    - `onAll`: подписка на все события
    - `offAll`: отмена всех подписок
    - `trigger`: создание функции-триггера для определённого события

### 4. **`Api.ts`**
Базовый класс для работы с HTTP-запросами:
- **Методы**:
    - `get`: выполнение GET-запроса
    - `post`: выполнение POST/PUT/DELETE-запроса
    - `handleResponse`: обработка ответа от сервера

### 5. **`LarekAPI.ts`**
Класс для взаимодействия с API интернет-магазина:
- **Методы**:
    - `getProductList`: получение списка товаров
    - `getProductItem`: получение информации о конкретном товаре
    - `orderProducts`: отправка заказа на сервер

### 6. **`AppData.ts`**
Центральная модель приложения:
- **Свойства**:
    - `catalog`: список товаров в каталоге
    - `order`: информация о текущем заказе
    - `formErrors`: ошибки валидации форм
- **Методы**:
    - `addToBasket`/`removeFromBasket`: управление корзиной
    - `getBasketItems`: получение товаров в корзине
    - `getTotal`: расчёт общей суммы заказа
    - `setCatalog`: установка каталога товаров
    - `validateOrder`: проверка валидности заказа
    - `setOrderField`: обновление полей заказа

### 7. **`Card.ts`**
Компоненты для отображения карточек товаров:
- **BaseCard**: базовый класс с общей функциональностью
- **CatalogItemCard**: карточка товара в каталоге
- **DetailCard**: расширенная карточка товара для модального окна
- **BasketCard**: карточка товара в корзине покупок

### 8. **`Form.ts`**
Базовый класс для создания форм:
- **Свойства**:
    - `valid`: флаг валидности формы
    - `errors`: список ошибок валидации
- **Методы**:
    - `render`: отображение формы с учётом состояния
    - `onInputChange`: обработка изменения значений полей

### 9. **`OrderAddressForm.ts`**
Форма ввода адреса доставки и способа оплаты:
- **Методы**:
    - `init`: инициализация формы и установка обработчиков
    - `reset`: сброс формы в исходное состояние
    - Валидаторы полей адреса и способа оплаты

### 10. **`OrderContactForm.ts`**
Форма ввода контактных данных:
- **Методы**:
    - `init`: инициализация формы и установка обработчиков
    - `reset`: сброс формы в исходное состояние
    - `showErrors`: отображение ошибок валидации
    - Валидаторы email и телефона

### 11. **`Modal.ts`**
Компонент модального окна:
- **Методы**:
    - `open`: открытие модального окна
    - `close`: закрытие модального окна и очистка содержимого
    - `render`: отображение модального окна с переданным содержимым

### 12. **`Basket.ts`**
Компонент корзины покупок:
- **Методы**:
    - `render`: отображение корзины с товарами
    - `reset`: очистка корзины
    - Обработчики добавления/удаления товаров

### 13. **`Page.ts`**
Компонент главной страницы:
- **Свойства**:
    - `counter`: счётчик товаров в корзине
    - `catalog`: список товаров для отображения
    - `locked`: блокировка взаимодействия с страницей
- **Методы**:
    - Обработчики взаимодействия с интерфейсом

## API Интерфейс

### Базовые URL
- **API Base URL**: `https://api.example.com/`
- **CDN Base URL**: `https://cdn.example.com/`

### Эндпоинты

#### 1. Получение всех товаров
- **URL**: `GET /product`
- **Ответ**:
```json
{
    "total": 15,
    "items": [
      {
        "id": "123",
        "title": "Название товара",
        "description": "Описание товара",
        "price": 1000,
        "category": "софт-скил",
        "image": "/images/product-123.jpg"
      },
      // и т.д.
    ]
  }
```


#### 2. Получение товара по ID
- **URL**: `GET /product/:id`
- **Параметры**:
    - `id`: ID товара
- **Ответ**:
```json
{
    "id": "123",
    "title": "Название товара",
    "description": "Описание товара",
    "price": 1000,
    "category": "софт-скил",
    "image": "/images/product-123.jpg"
  }
```


#### 3. Оформление заказа
- **URL**: `POST /order`
- **Тело запроса**:
```json
{
    "payment": "card",
    "address": "г. Москва, ул. Примерная, д. 1",
    "email": "user@example.com",
    "phone": "+7 (123) 456-78-90",
    "items": ["123", "456"]
  }
```

- **Ответ**:
```json
{
    "id": "order-789",
    "total": 2500
  }
```


### Коды ошибок
- **400** - Некорректный запрос (неверные параметры)
- **401** - Не авторизован
- **404** - Ресурс не найден
- **500** - Внутренняя ошибка сервера

## Форматы данных

### Товар (IProduct)
```typescript
{
  id: string;             // Уникальный идентификатор
  title: string;          // Название товара
  description: string;    // Описание товара
  price: number;          // Цена товара
  category: ProductCategory; // Категория товара
  image: string;          // URL изображения
  quantity?: number;      // Опциональное поле для количества
}
```


### Заказ (IOrder)
```typescript
{
  payment: string;        // Способ оплаты: "card" | "cash"
  address: string;        // Адрес доставки
  email: string;          // Электронная почта
  phone: string;          // Телефон
  items: string[];        // Массив ID товаров
  total?: number;         // Общая сумма заказа (опционально)
  [key: string]: unknown; // Дополнительные поля
}
```


### Результат заказа (IOrderResult)
```typescript
{
  id: string;             // Идентификатор заказа
  total: number;          // Итоговая сумма
}
```


### Состояние приложения (IAppState)
```typescript
{
  catalog: IProduct[];    // Каталог товаров
  basket: string[];       // ID товаров в корзине
  preview: string | null; // ID предпросматриваемого товара
  order: IOrder | null;   // Текущий заказ
  loading: boolean;       // Флаг загрузки данных
}
```


### Категории товаров (ProductCategory)
```typescript
type ProductCategory =
  | 'другое'
  | 'софт-скил'
  | 'хард-скил'
  | 'кнопка'
  | 'дополнительное';
```


## Процесс покупки

### 1. Просмотр каталога
Пользователь попадает на главную страницу и видит каталог доступных товаров, сгруппированных по категориям. Каждая карточка товара содержит основную информацию: название, изображение, категорию и цену.

### 2. Просмотр детальной информации
При клике на карточку товара открывается модальное окно с детальной информацией, включая подробное описание товара. Здесь пользователь может добавить товар в корзину с помощью соответствующей кнопки.

### 3. Управление корзиной
Пользователь может добавлять товары в корзину и видеть общее количество товаров в счётчике в верхней части страницы. При клике на иконку корзины открывается модальное окно со списком выбранных товаров, общей суммой и возможностью удаления отдельных позиций.

### 4. Оформление заказа
Процесс оформления заказа разделен на два шага:

#### Шаг 1: Выбор способа оплаты и адрес доставки
- Пользователь выбирает способ оплаты: "Картой" или "Наличными"
- Вводит адрес доставки
- Нажимает кнопку "Далее"

#### Шаг 2: Ввод контактных данных
- Вводит email в формате user@example.com
- Вводит телефон в формате +7 (123) 456-78-90
- Нажимает кнопку "Оплатить"

### 5. Подтверждение заказа
После успешного оформления заказа пользователь видит уведомление с информацией о списанной сумме. После закрытия уведомления корзина очищается, и пользователь возвращается к каталогу товаров.